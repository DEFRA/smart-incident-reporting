{% extends 'form-layout.html' %}

{% block pageTitle %}
Question page template – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% block beforeContent %}
{{ govukBackLink({
text: "Back",
href: "javascript:window.history.back()"
}) }}
{% endblock %}

{% block content %}

<!-- Include leaflet -->
<link crossorigin="" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      rel="stylesheet"/>
<!-- Make sure you put this AFTER Leaflet's CSS -->
<script crossorigin=""
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Include geosearch -->
<link href="https://unpkg.com/leaflet-geosearch@3.0.6/dist/geosearch.css" rel="stylesheet">
<script src="https://unpkg.com/leaflet-geosearch@3.0.6/dist/geosearch.umd.js"></script>
<!-- this is for the map using shapes -->


<form action="/water-quality/location-mapping-option" method="post">
    <input id="mapx" name="mapx" type="hidden"/>
    <input id="mapy" name="mapy" type="hidden"/>

    <div class="govuk-grid-row">

        <div class="govuk-grid-column-two-thirds">
            <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
                <h1 class="govuk-fieldset__heading">
                    Mark the location on the map
                </h1>
                <div class="govuk-hint" id="location-hint">
                    Enter town, postcode or location name to search the map. Double tap or click to place a pin. When
                    you're happy with the location, continue.
                </div>
            </legend>
            <div id="map" style="min-height:600px; width: 100%; height: 100%;"></div>
            <br><br><br>

            {{ govukButton({
            text: "Continue",
            isStartButton: false
            }) }}

        </div>
    </div>

</form>

<!-- this is for the map using shapes -->
<script>
  const map = L.map('map').setView([51.5072, -0.1276], 100)
  L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '© OpenStreetMap'
  }).addTo(map)

  var marker = L.marker([51.5072, -0.1276]).addTo(map)

  var popup = L.popup()

  function onMapClick (e) {
    document.getElementById('mapx').value = e.latlng.lat
    document.getElementById('mapy').value = e.latlng.lng

    popup
      .setLatLng(e.latlng)
      .setContent('You clicked the map at ' + e.latlng.toString())
      .openOn(map)
  }

  map.on('click', onMapClick)

  // L.tileLayer('//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

  // const search = new GeoSearch.GeoSearchControl({
  //   provider: new GeoSearch.OpenStreetMapProvider(),
  //   style: 'bar'
  // });
  //
  // map.addControl(search);

</script>


{% endblock %}
